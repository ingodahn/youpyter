function getBrowserLanguage(){return(navigator.language||navigator.userLanguage).substring(0,2)}function syncTo(e){$(".cell").removeClass("current-cell");let t=null;for(var n=0;n<data.nbCells.length;n++)if(e>=data.nbCells[n].start&&e<data.nbCells[n].end){let e="#"+data.nbCells[n].content;t||(t=e),$(e).addClass("current-cell")}checkEvaluated(),$(t)[0].scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}function checkEvaluated(){let e=null;$(".cell").removeClass(["evaluated","evaluable","notEvaluated"]);for(let t=0;t<data.nbCells.length;t++)"code"==data.nbCells[t].cellType&&(data.nbCells[t].cellEvaluated?$("#"+data.nbCells[t].content).addClass("evaluated"):null==e?(e=data.nbCells[t].content,$("#"+e).addClass("evaluable")):$("#"+data.nbCells[t].content).addClass("notEvaluated"));return e?$("#calcNext").prop("disabled",!1):$("#calcNext").prop("disabled",!0),e}function sageCell(e){return'<div class="compute"><script type="text/x-sage">'+e+"<\/script></div>"}function makeSageCells(){sagecell.makeSagecell({inputLocation:".compute",linked:!0,language:data.kernel,callback:()=>{$(".sagecell_evalButton").click((function(){let e=this.parentNode.parentNode.parentNode.parentNode.id,t=data.nbCells.findIndex((t=>t.content==e));data.nbCells[t].cellEvaluated=!0,checkEvaluated()}))}})}function calcNext(){let e=null;for(let t=0;t<data.nbCells.length;t++)if("code"==data.nbCells[t].cellType&&!data.nbCells[t].cellEvaluated){e=data.nbCells[t].start;break}player.seekTo(e),syncTo(e)}function saveHtml(){$("script").html().replace(/\u200B/g,"");var e=new Blob(['<!DOCTYPE html>\n<html>\n<head><head>\n <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"><\/script>\n <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">\n <script src="'+data.system+'/vendor/js/FileSaver.min.js"><\/script>\n <script src="https://cdn.jsdelivr.net/remarkable/1.7.1/remarkable.min.js"><\/script>\n <script type="text/javascript">window.MathJax = {\n     tex: {\n       inlineMath: [["$", "$"], ["\\\\(", "\\\\)"]],\n       displayMath: [["$$", "$$"], ["\\\\[", "\\\\]"]],\n       processEscapes: true,\n       processEnvironments: true,\n     },\n     options: {\n       renderActions: { /* remove when dropping MathJax2 compatibility */\n         find_script_mathtex: [10, function (doc) {\n           for (const node of document.querySelectorAll(\'script[type^="math/tex"]\')) {\n             const display = !!node.type.match(/; *mode=display/);\n             const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);\n             const text = document.createTextNode(\'\');\n             node.parentNode.replaceChild(text, node);\n             math.start = { node: text, delim: \'\', n: 0 };\n             math.end = { node: text, delim: \'\', n: 0 };\n             doc.math.push(math);\n           }\n         }, \'\']\n       }\n     }\n   };<\/script>\n   <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"><\/script>\n <script src="https://sagecell.sagemath.org/embedded_sagecell.js"><\/script>\n <script src="'+data.system+'/ytcontrol-min.js"><\/script>\n <script src="'+data.system+'/ytrunner-min.js"><\/script>\n <link rel="stylesheet" href="'+data.system+'/ytactivator-min.css">\n</head>\n<body>\n<div id="main">\n<row>\n      <div id="player-nav">\n        <div id="player-wrapper"></div>\n        <select id="toc" onchange="if (this.selectedIndex) ytSeekTo(this.selectedIndex)"></select>\n        <button id="calcNext" type="button" class="btn btn-primary" onclick="calcNext()">Next Calculation</button>\n        <button id="save" type="button" class="btn btn-primary" onclick="saveHtml()">Save</button>\n      </div>\n    </row>\n    <div id=\'notebook-wrapper\'>'+$("#notebook-wrapper").html()+"</div>\n  </div>\n  <script>\n    var data ="+JSON.stringify(data)+";\n    makeYtPlayer();\n    makeToc();\n    makeSageCells();\n    window.MathJax.typeset();\n  <\/script>\n  </body></html>"],{type:"text/plain;charset=utf-8"});saveAs(e,"testplayer.html");let t="Do NOT use this page anymore - open your saved copy or reload this page.";"de"==getBrowserLanguage()&&(t="Bitte die Seite neu laden oder die gespeicherte Kopie Ã¶ffnen."),$("#navbar").html('<div class="save-warning">'+t+"</div>")}function saveAddSageCells(e,t){$(e).each((function(){$(this).append("\n  <div class='compute'>\n    <script type='text/x-sage'>1+1<\/script>\n  </div>");let e=getSageInput($(this));e=e.replace(/\u200B/g,""),$(this).find(".compute script").text(e),t&&$(this).find(t).remove(),$(this).find(".compute").hide()}))}function getSageInput(e){let t="";return e.find(".CodeMirror-line").each((function(){t+=$(this).text()+"\n"})),t}function makeToc(){for(let e=0;e<data.segments.length;e++)$("#toc").append('<option value="'+data.segments[e].start+'">'+data.segments[e].title+"</option>")}